WARNING: ThreadSanitizer: data race (pid=1185)
  Write of size 1 at 0x7b340005d160 by main thread:
    #0 pthread_mutex_destroy /builds/worker/fetches/llvm-project/llvm/projects/compiler-rt/lib/tsan/rtl/tsan_interceptors.cc:1242:3 (firefox+0x58976)
    #1 mozilla::detail::MutexImpl::~MutexImpl() /builds/worker/workspace/build/src/mozglue/misc/Mutex_posix.cpp:119:3 (firefox+0x122fc8)
    #2 ~OffTheBooksMutex /builds/worker/workspace/build/src/obj-firefox/dist/include/mozilla/Mutex.h:60:3 (libxul.so+0x3a822d5)
    #3 ~Mutex /builds/worker/workspace/build/src/obj-firefox/dist/include/mozilla/Mutex.h:133:37 (libxul.so+0x3a822d5)
    #4 ~Monitor /builds/worker/workspace/build/src/obj-firefox/dist/include/mozilla/Monitor.h:30:22 (libxul.so+0x3a822d5)
    #5 mozilla::MediaCache::~MediaCache() /builds/worker/workspace/build/src/dom/media/MediaCache.cpp:317:3 (libxul.so+0x3a822d5)
    #6 Release /builds/worker/workspace/build/src/dom/media/MediaCache.cpp:150:3 (libxul.so+0x3a81b25)
    #7 detail::ProxyReleaseEvent<mozilla::MediaCache>::Run() /builds/worker/workspace/build/src/obj-firefox/dist/include/nsProxyRelease.h:36:5 (libxul.so+0x3a81b25)
    #8 mozilla::SchedulerGroup::Runnable::Run() /builds/worker/workspace/build/src/xpcom/threads/SchedulerGroup.cpp:282:20 (libxul.so+0xa5603a)
    #9 nsThread::ProcessNextEvent(bool, bool*) /builds/worker/workspace/build/src/xpcom/threads/nsThread.cpp:1220:14 (libxul.so+0xa6e673)
    #10 NS_ProcessNextEvent(nsIThread*, bool) /builds/worker/workspace/build/src/xpcom/threads/nsThreadUtils.cpp:481:10 (libxul.so+0xa73272)
    #11 SpinEventLoopUntil<mozilla::ProcessFailureBehavior::ReportToCaller, (lambda at /builds/worker/workspace/build/src/xpcom/threads/nsThread.cpp:909:22)> /builds/worker/workspace/build/src/obj-firefox/dist/include/nsThreadUtils.h:342:25 (libxul.so+0xa6d629)
    #12 nsThread::Shutdown() /builds/worker/workspace/build/src/xpcom/threads/nsThread.cpp:909:3 (libxul.so+0xa6d629)
    #13 nsThreadPool::Shutdown() /builds/worker/workspace/build/src/xpcom/threads/nsThreadPool.cpp:396:17 (libxul.so+0xa761d4)
    #14 applyImpl<nsIThreadPool, nsresult (nsIThreadPool::*)()> /builds/worker/workspace/build/src/obj-firefox/dist/include/nsThreadUtils.h:1160:12 (libxul.so+0xa5d406)
    #15 apply<nsIThreadPool, nsresult (nsIThreadPool::*)()> /builds/worker/workspace/build/src/obj-firefox/dist/include/nsThreadUtils.h:1166:12 (libxul.so+0xa5d406)
    #16 mozilla::detail::RunnableMethodImpl<nsCOMPtr<nsIThreadPool>, nsresult (nsIThreadPool::*)(), true, (mozilla::RunnableKind)0>::Run() /builds/worker/workspace/build/src/obj-firefox/dist/include/nsThreadUtils.h:1212:13 (libxul.so+0xa5d406)
    #17 nsThread::ProcessNextEvent(bool, bool*) /builds/worker/workspace/build/src/xpcom/threads/nsThread.cpp:1220:14 (libxul.so+0xa6e673)
    #18 NS_ProcessNextEvent(nsIThread*, bool) /builds/worker/workspace/build/src/xpcom/threads/nsThreadUtils.cpp:481:10 (libxul.so+0xa73272)
    #19 SpinEventLoopUntil<mozilla::ProcessFailureBehavior::ReportToCaller, (lambda at /builds/worker/workspace/build/src/xpcom/threads/nsThread.cpp:909:22)> /builds/worker/workspace/build/src/obj-firefox/dist/include/nsThreadUtils.h:342:25 (libxul.so+0xa6d629)
    #20 nsThread::Shutdown() /builds/worker/workspace/build/src/xpcom/threads/nsThread.cpp:909:3 (libxul.so+0xa6d629)
    #21 nsThreadPool::Shutdown() /builds/worker/workspace/build/src/xpcom/threads/nsThreadPool.cpp:396:17 (libxul.so+0xa761d4)
    #22 applyImpl<nsIThreadPool, nsresult (nsIThreadPool::*)()> /builds/worker/workspace/build/src/obj-firefox/dist/include/nsThreadUtils.h:1160:12 (libxul.so+0xa5d406)
    #23 apply<nsIThreadPool, nsresult (nsIThreadPool::*)()> /builds/worker/workspace/build/src/obj-firefox/dist/include/nsThreadUtils.h:1166:12 (libxul.so+0xa5d406)
    #24 mozilla::detail::RunnableMethodImpl<nsCOMPtr<nsIThreadPool>, nsresult (nsIThreadPool::*)(), true, (mozilla::RunnableKind)0>::Run() /builds/worker/workspace/build/src/obj-firefox/dist/include/nsThreadUtils.h:1212:13 (libxul.so+0xa5d406)
    #25 nsThread::ProcessNextEvent(bool, bool*) /builds/worker/workspace/build/src/xpcom/threads/nsThread.cpp:1220:14 (libxul.so+0xa6e673)
    #26 NS_ProcessNextEvent(nsIThread*, bool) /builds/worker/workspace/build/src/xpcom/threads/nsThreadUtils.cpp:481:10 (libxul.so+0xa73272)
    #27 SpinEventLoopUntil<mozilla::ProcessFailureBehavior::ReportToCaller, (lambda at /builds/worker/workspace/build/src/xpcom/threads/nsThread.cpp:909:22)> /builds/worker/workspace/build/src/obj-firefox/dist/include/nsThreadUtils.h:342:25 (libxul.so+0xa6d629)
    #28 nsThread::Shutdown() /builds/worker/workspace/build/src/xpcom/threads/nsThread.cpp:909:3 (libxul.so+0xa6d629)
    #29 nsThreadPool::Shutdown() /builds/worker/workspace/build/src/xpcom/threads/nsThreadPool.cpp:396:17 (libxul.so+0xa761d4)
    #30 applyImpl<nsIThreadPool, nsresult (nsIThreadPool::*)()> /builds/worker/workspace/build/src/obj-firefox/dist/include/nsThreadUtils.h:1160:12 (libxul.so+0xa5d406)
    #31 apply<nsIThreadPool, nsresult (nsIThreadPool::*)()> /builds/worker/workspace/build/src/obj-firefox/dist/include/nsThreadUtils.h:1166:12 (libxul.so+0xa5d406)
    #32 mozilla::detail::RunnableMethodImpl<nsCOMPtr<nsIThreadPool>, nsresult (nsIThreadPool::*)(), true, (mozilla::RunnableKind)0>::Run() /builds/worker/workspace/build/src/obj-firefox/dist/include/nsThreadUtils.h:1212:13 (libxul.so+0xa5d406)
    #33 nsThread::ProcessNextEvent(bool, bool*) /builds/worker/workspace/build/src/xpcom/threads/nsThread.cpp:1220:14 (libxul.so+0xa6e673)
    #34 NS_ProcessNextEvent(nsIThread*, bool) /builds/worker/workspace/build/src/xpcom/threads/nsThreadUtils.cpp:481:10 (libxul.so+0xa73272)
    #35 SpinEventLoopUntil<mozilla::ProcessFailureBehavior::ReportToCaller, (lambda at /builds/worker/workspace/build/src/xpcom/threads/nsThread.cpp:909:22)> /builds/worker/workspace/build/src/obj-firefox/dist/include/nsThreadUtils.h:342:25 (libxul.so+0xa6d629)
    #36 nsThread::Shutdown() /builds/worker/workspace/build/src/xpcom/threads/nsThread.cpp:909:3 (libxul.so+0xa6d629)
    #37 nsThreadPool::Shutdown() /builds/worker/workspace/build/src/xpcom/threads/nsThreadPool.cpp:396:17 (libxul.so+0xa761d4)
    #38 applyImpl<nsIThreadPool, nsresult (nsIThreadPool::*)()> /builds/worker/workspace/build/src/obj-firefox/dist/include/nsThreadUtils.h:1160:12 (libxul.so+0xa5d406)
    #39 apply<nsIThreadPool, nsresult (nsIThreadPool::*)()> /builds/worker/workspace/build/src/obj-firefox/dist/include/nsThreadUtils.h:1166:12 (libxul.so+0xa5d406)
    #40 mozilla::detail::RunnableMethodImpl<nsCOMPtr<nsIThreadPool>, nsresult (nsIThreadPool::*)(), true, (mozilla::RunnableKind)0>::Run() /builds/worker/workspace/build/src/obj-firefox/dist/include/nsThreadUtils.h:1212:13 (libxul.so+0xa5d406)
    #41 nsThread::ProcessNextEvent(bool, bool*) /builds/worker/workspace/build/src/xpcom/threads/nsThread.cpp:1220:14 (libxul.so+0xa6e673)
    #42 NS_ProcessNextEvent(nsIThread*, bool) /builds/worker/workspace/build/src/xpcom/threads/nsThreadUtils.cpp:481:10 (libxul.so+0xa73272)
    #43 mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) /builds/worker/workspace/build/src/ipc/glue/MessagePump.cpp:87:21 (libxul.so+0x12ae4f9)
    #44 mozilla::ipc::MessagePumpForChildProcess::Run(base::MessagePump::Delegate*) /builds/worker/workspace/build/src/ipc/glue/MessagePump.cpp:270:30 (libxul.so+0x12aef0b)
    #45 RunInternal /builds/worker/workspace/build/src/ipc/chromium/src/base/message_loop.cc:315:10 (libxul.so+0x12422cc)
    #46 RunHandler /builds/worker/workspace/build/src/ipc/chromium/src/base/message_loop.cc:308:3 (libxul.so+0x12422cc)
    #47 MessageLoop::Run() /builds/worker/workspace/build/src/ipc/chromium/src/base/message_loop.cc:290:3 (libxul.so+0x12422cc)
    #48 nsBaseAppShell::Run() /builds/worker/workspace/build/src/widget/nsBaseAppShell.cpp:137:27 (libxul.so+0x46ff3e3)
    #49 XRE_RunAppShell() /builds/worker/workspace/build/src/toolkit/xre/nsEmbedFunctions.cpp:943:20 (libxul.so+0x6329ad9)
    #50 mozilla::ipc::MessagePumpForChildProcess::Run(base::MessagePump::Delegate*) /builds/worker/workspace/build/src/ipc/glue/MessagePump.cpp:237:9 (libxul.so+0x12aeeba)
    #51 RunInternal /builds/worker/workspace/build/src/ipc/chromium/src/base/message_loop.cc:315:10 (libxul.so+0x12422cc)
    #52 RunHandler /builds/worker/workspace/build/src/ipc/chromium/src/base/message_loop.cc:308:3 (libxul.so+0x12422cc)
    #53 MessageLoop::Run() /builds/worker/workspace/build/src/ipc/chromium/src/base/message_loop.cc:290:3 (libxul.so+0x12422cc)
    #54 XRE_InitChildProcess(int, char**, XREChildData const*) /builds/worker/workspace/build/src/toolkit/xre/nsEmbedFunctions.cpp:778:34 (libxul.so+0x6329850)
    #55 mozilla::BootstrapImpl::XRE_InitChildProcess(int, char**, XREChildData const*) /builds/worker/workspace/build/src/toolkit/xre/Bootstrap.cpp:67:12 (libxul.so+0x6331542)
    #56 content_process_main /builds/worker/workspace/build/src/browser/app/../../ipc/contentproc/plugin-container.cpp:56:28 (firefox+0xc87c7)
    #57 main /builds/worker/workspace/build/src/browser/app/nsBrowserApp.cpp:303:18 (firefox+0xc87c7)
  Previous atomic read of size 1 at 0x7b340005d160 by thread T28 (mutexes: write M169301924272001376):
    #0 pthread_mutex_unlock /builds/worker/fetches/llvm-project/llvm/projects/compiler-rt/lib/tsan/../sanitizer_common/sanitizer_common_interceptors.inc:4153:3 (firefox+0x755a6)
    #1 mozilla::detail::MutexImpl::unlock() /builds/worker/workspace/build/src/mozglue/misc/Mutex_posix.cpp:185:3 (firefox+0x1231e8)
    #2 Unlock /builds/worker/workspace/build/src/obj-firefox/dist/include/mozilla/Mutex.h:76:25 (libxul.so+0x3a872a1)
    #3 Unlock /builds/worker/workspace/build/src/obj-firefox/dist/include/mozilla/Monitor.h:34:26 (libxul.so+0x3a872a1)
    #4 ~MonitorAutoLock /builds/worker/workspace/build/src/obj-firefox/dist/include/mozilla/Monitor.h:70:34 (libxul.so+0x3a872a1)
    #5 operator() /builds/worker/workspace/build/src/dom/media/MediaCache.cpp:762:7 (libxul.so+0x3a872a1)
    #6 mozilla::detail::RunnableFunction<mozilla::MediaCache::CloseStreamsForPrivateBrowsing()::$_2>::Run() /builds/worker/workspace/build/src/obj-firefox/dist/include/nsThreadUtils.h:559:5 (libxul.so+0x3a872a1)
    #7 nsThread::ProcessNextEvent(bool, bool*) /builds/worker/workspace/build/src/xpcom/threads/nsThread.cpp:1220:14 (libxul.so+0xa6e673)
    #8 NS_ProcessNextEvent(nsIThread*, bool) /builds/worker/workspace/build/src/xpcom/threads/nsThreadUtils.cpp:481:10 (libxul.so+0xa73272)
    #9 mozilla::ipc::MessagePumpForNonMainThreads::Run(base::MessagePump::Delegate*) /builds/worker/workspace/build/src/ipc/glue/MessagePump.cpp:332:5 (libxul.so+0x12af068)
    #10 RunInternal /builds/worker/workspace/build/src/ipc/chromium/src/base/message_loop.cc:315:10 (libxul.so+0x12422cc)
    #11 RunHandler /builds/worker/workspace/build/src/ipc/chromium/src/base/message_loop.cc:308:3 (libxul.so+0x12422cc)
    #12 MessageLoop::Run() /builds/worker/workspace/build/src/ipc/chromium/src/base/message_loop.cc:290:3 (libxul.so+0x12422cc)
    #13 nsThread::ThreadFunc(void*) /builds/worker/workspace/build/src/xpcom/threads/nsThread.cpp:464:10 (libxul.so+0xa6adb5)
    #14 _pt_root /builds/worker/workspace/build/src/nsprpub/pr/src/pthreads/ptthread.c:201:5 (libnspr4.so+0x46a4f)
  Location is heap block of size 200 at 0x7b340005d150 allocated by main thread:
    #0 malloc /builds/worker/fetches/llvm-project/llvm/projects/compiler-rt/lib/tsan/rtl/tsan_interceptors.cc:650:5 (firefox+0x558c4)
    #1 moz_xmalloc /builds/worker/workspace/build/src/memory/mozalloc/mozalloc.cpp:52:15 (firefox+0xc9e48)
    #2 operator new /builds/worker/workspace/build/src/obj-firefox/dist/include/mozilla/cxxalloc.h:33:10 (libxul.so+0x3a61ca0)
    #3 mozilla::MediaCache::GetMediaCache(long) /builds/worker/workspace/build/src/dom/media/MediaCache.cpp:801:31 (libxul.so+0x3a61ca0)
    #4 mozilla::MediaCacheStream::Init(long) /builds/worker/workspace/build/src/dom/media/MediaCache.cpp:2661:17 (libxul.so+0x3a6b530)
    #5 mozilla::ChannelMediaResource::Open(nsIStreamListener**) /builds/worker/workspace/build/src/dom/media/ChannelMediaResource.cpp:520:30 (libxul.so+0x3a3f7bc)
    #6 mozilla::ChannelMediaDecoder::Load(nsIChannel*, bool, nsIStreamListener**) /builds/worker/workspace/build/src/dom/media/ChannelMediaDecoder.cpp:264:19 (libxul.so+0x3a3bc09)
    #7 nsresult mozilla::dom::HTMLMediaElement::SetupDecoder<mozilla::ChannelMediaDecoder, nsIChannel*&, bool&, nsIStreamListener**&>(mozilla::ChannelMediaDecoder*, nsIChannel*&, bool&, nsIStreamListener**&) /builds/worker/workspace/build/src/dom/html/HTMLMediaElement.cpp:5046:27 (libxul.so+0x3949095)
    #8 mozilla::dom::HTMLMediaElement::InitializeDecoderForChannel(nsIChannel*, nsIStreamListener**) /builds/worker/workspace/build/src/dom/html/HTMLMediaElement.cpp:5129:10 (libxul.so+0x392864a)
    #9 mozilla::dom::HTMLMediaElement::MediaLoadListener::OnStartRequest(nsIRequest*) /builds/worker/workspace/build/src/dom/html/HTMLMediaElement.cpp:1244:7 (libxul.so+0x3927906)
    #10 mozilla::net::HttpChannelChild::DoOnStartRequest(nsIRequest*, nsISupports*) /builds/worker/workspace/build/src/netwerk/protocol/http/HttpChannelChild.cpp:707:20 (libxul.so+0xfdf0de)
    #11 mozilla::net::HttpChannelChild::OnStartRequest(nsresult const&, mozilla::net::nsHttpResponseHead const&, bool const&, mozilla::net::nsHttpHeaderArray const&, mozilla::net::ParentLoadInfoForwarderArgs const&, bool const&, bool const&, bool const&, unsigned long const&, int const&, unsigned int const&, nsTString<char> const&, nsTString<char> const&, mozilla::net::NetAddr const&, mozilla::net::NetAddr const&, unsigned int const&, nsTString<char> const&, long const&, bool const&, bool const&, bool const&, mozilla::net::ResourceTimingStructArgs const&, bool const&, mozilla::Maybe<unsigned int> const&, bool const&, nsILoadInfo::CrossOriginOpenerPolicy const&) /builds/worker/workspace/build/src/netwerk/protocol/http/HttpChannelChild.cpp:557:3 (libxul.so+0xfe58c0)
    #12 operator() /builds/worker/workspace/build/src/netwerk/protocol/http/HttpChannelChild.cpp:411:15 (libxul.so+0x102a422)
    #13 std::_Function_handler<void (), mozilla::net::HttpChannelChild::RecvOnStartRequest(nsresult const&, mozilla::net::nsHttpResponseHead const&, bool const&, mozilla::net::nsHttpHeaderArray const&, mozilla::net::ParentLoadInfoForwarderArgs const&, bool const&, bool const&, bool const&, unsigned long const&, int const&, unsigned int const&, nsTString<char> const&, nsTString<char> const&, mozilla::net::NetAddr const&, mozilla::net::NetAddr const&, short const&, unsigned int const&, nsTString<char> const&, long const&, bool const&, bool const&, bool const&, mozilla::net::ResourceTimingStructArgs const&, bool const&, mozilla::Maybe<unsigned int> const&, bool const&, nsILoadInfo::CrossOriginOpenerPolicy const&)::$_5>::_M_invoke(std::_Any_data const&) /builds/worker/fetches/clang/bin/../lib/gcc/x86_64-unknown-linux-gnu/7.4.0/../../../../include/c++/7.4.0/bits/std_function.h:316:2 (libxul.so+0x102a422)
    #14 operator() /builds/worker/fetches/clang/bin/../lib/gcc/x86_64-unknown-linux-gnu/7.4.0/../../../../include/c++/7.4.0/bits/std_function.h:706:14 (libxul.so+0xf59143)
    #15 mozilla::net::ChannelFunctionEvent::Run() /builds/worker/workspace/build/src/obj-firefox/dist/include/mozilla/net/ChannelEventQueue.h:80:25 (libxul.so+0xf59143)
    #16 mozilla::net::ChannelEventQueue::RunOrEnqueue(mozilla::net::ChannelEvent*, bool) /builds/worker/workspace/build/src/obj-firefox/dist/include/mozilla/net/ChannelEventQueue.h:261:10 (libxul.so+0xf41d95)
    #17 mozilla::net::HttpChannelChild::RecvOnStartRequest(nsresult const&, mozilla::net::nsHttpResponseHead const&, bool const&, mozilla::net::nsHttpHeaderArray const&, mozilla::net::ParentLoadInfoForwarderArgs const&, bool const&, bool const&, bool const&, unsigned long const&, int const&, unsigned int const&, nsTString<char> const&, nsTString<char> const&, mozilla::net::NetAddr const&, mozilla::net::NetAddr const&, short const&, unsigned int const&, nsTString<char> const&, long const&, bool const&, bool const&, bool const&, mozilla::net::ResourceTimingStructArgs const&, bool const&, mozilla::Maybe<unsigned int> const&, bool const&, nsILoadInfo::CrossOriginOpenerPolicy const&) /builds/worker/workspace/build/src/netwerk/protocol/http/HttpChannelChild.cpp:401:12 (libxul.so+0xfe4c65)
    #18 mozilla::net::PHttpChannelChild::OnMessageReceived(IPC::Message const&) /builds/worker/workspace/build/src/obj-firefox/ipc/ipdl/PHttpChannelChild.cpp:862:28 (libxul.so+0x14b5303)
    #19 mozilla::dom::PContentChild::OnMessageReceived(IPC::Message const&) /builds/worker/workspace/build/src/obj-firefox/ipc/ipdl/PContentChild.cpp:8355:32 (libxul.so+0x13af7d0)
    #20 mozilla::dom::ContentChild::OnMessageReceived(IPC::Message const&) /builds/worker/workspace/build/src/dom/ipc/ContentChild.cpp:3877:25 (libxul.so+0x427d540)
    #21 mozilla::ipc::MessageChannel::DispatchAsyncMessage(mozilla::ipc::ActorLifecycleProxy*, IPC::Message const&) /builds/worker/workspace/build/src/ipc/glue/MessageChannel.cpp:2215:25 (libxul.so+0x12aaaf6)
    #22 mozilla::ipc::MessageChannel::DispatchMessage(IPC::Message&&) /builds/worker/workspace/build/src/ipc/glue/MessageChannel.cpp:2137:9 (libxul.so+0x12a916a)
    #23 mozilla::ipc::MessageChannel::RunMessage(mozilla::ipc::MessageChannel::MessageTask&) /builds/worker/workspace/build/src/ipc/glue/MessageChannel.cpp:1976:3 (libxul.so+0x12a9d51)
    #24 mozilla::ipc::MessageChannel::MessageTask::Run() /builds/worker/workspace/build/src/ipc/glue/MessageChannel.cpp:2007:13 (libxul.so+0x12aa289)
    #25 mozilla::SchedulerGroup::Runnable::Run() /builds/worker/workspace/build/src/xpcom/threads/SchedulerGroup.cpp:282:20 (libxul.so+0xa5603a)
    #26 nsThread::ProcessNextEvent(bool, bool*) /builds/worker/workspace/build/src/xpcom/threads/nsThread.cpp:1220:14 (libxul.so+0xa6e673)
    #27 NS_ProcessNextEvent(nsIThread*, bool) /builds/worker/workspace/build/src/xpcom/threads/nsThreadUtils.cpp:481:10 (libxul.so+0xa73272)
    #28 mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) /builds/worker/workspace/build/src/ipc/glue/MessagePump.cpp:87:21 (libxul.so+0x12ae4f9)
    #29 mozilla::ipc::MessagePumpForChildProcess::Run(base::MessagePump::Delegate*) /builds/worker/workspace/build/src/ipc/glue/MessagePump.cpp:270:30 (libxul.so+0x12aef0b)
    #30 RunInternal /builds/worker/workspace/build/src/ipc/chromium/src/base/message_loop.cc:315:10 (libxul.so+0x12422cc)
    #31 RunHandler /builds/worker/workspace/build/src/ipc/chromium/src/base/message_loop.cc:308:3 (libxul.so+0x12422cc)
    #32 MessageLoop::Run() /builds/worker/workspace/build/src/ipc/chromium/src/base/message_loop.cc:290:3 (libxul.so+0x12422cc)
    #33 nsBaseAppShell::Run() /builds/worker/workspace/build/src/widget/nsBaseAppShell.cpp:137:27 (libxul.so+0x46ff3e3)
    #34 XRE_RunAppShell() /builds/worker/workspace/build/src/toolkit/xre/nsEmbedFunctions.cpp:943:20 (libxul.so+0x6329ad9)
    #35 mozilla::ipc::MessagePumpForChildProcess::Run(base::MessagePump::Delegate*) /builds/worker/workspace/build/src/ipc/glue/MessagePump.cpp:237:9 (libxul.so+0x12aeeba)
    #36 RunInternal /builds/worker/workspace/build/src/ipc/chromium/src/base/message_loop.cc:315:10 (libxul.so+0x12422cc)
    #37 RunHandler /builds/worker/workspace/build/src/ipc/chromium/src/base/message_loop.cc:308:3 (libxul.so+0x12422cc)
    #38 MessageLoop::Run() /builds/worker/workspace/build/src/ipc/chromium/src/base/message_loop.cc:290:3 (libxul.so+0x12422cc)
    #39 XRE_InitChildProcess(int, char**, XREChildData const*) /builds/worker/workspace/build/src/toolkit/xre/nsEmbedFunctions.cpp:778:34 (libxul.so+0x6329850)
    #40 mozilla::BootstrapImpl::XRE_InitChildProcess(int, char**, XREChildData const*) /builds/worker/workspace/build/src/toolkit/xre/Bootstrap.cpp:67:12 (libxul.so+0x6331542)
    #41 content_process_main /builds/worker/workspace/build/src/browser/app/../../ipc/contentproc/plugin-container.cpp:56:28 (firefox+0xc87c7)
    #42 main /builds/worker/workspace/build/src/browser/app/nsBrowserApp.cpp:303:18 (firefox+0xc87c7)
  Mutex M169301924272001376 is already destroyed.
  Thread T28 'MediaCache' (tid=1299, running) created by main thread at:
    #0 pthread_create /builds/worker/fetches/llvm-project/llvm/projects/compiler-rt/lib/tsan/rtl/tsan_interceptors.cc:967:3 (firefox+0x571ab)
    #1 _PR_CreateThread /builds/worker/workspace/build/src/nsprpub/pr/src/pthreads/ptthread.c:458:14 (libnspr4.so+0x3dc53)
    #2 PR_CreateThread /builds/worker/workspace/build/src/nsprpub/pr/src/pthreads/ptthread.c:533:12 (libnspr4.so+0x32152)
    #3 nsThread::Init(nsTSubstring<char> const&) /builds/worker/workspace/build/src/xpcom/threads/nsThread.cpp:670:8 (libxul.so+0xa6c24a)
    #4 nsThreadManager::NewNamedThread(nsTSubstring<char> const&, unsigned int, nsIThread**) /builds/worker/workspace/build/src/xpcom/threads/nsThreadManager.cpp:621:12 (libxul.so+0xa72975)
    #5 NS_NewNamedThread(nsTSubstring<char> const&, nsIThread**, nsIRunnable*, unsigned int) /builds/worker/workspace/build/src/xpcom/threads/nsThreadUtils.cpp:139:57 (libxul.so+0xa74a68)
    #6 NS_NewNamedThread<11> /builds/worker/workspace/build/src/obj-firefox/dist/include/nsThreadUtils.h:65:10 (libxul.so+0x3a61a76)
    #7 mozilla::MediaCache::GetMediaCache(long) /builds/worker/workspace/build/src/dom/media/MediaCache.cpp:772:19 (libxul.so+0x3a61a76)
    #8 mozilla::MediaCacheStream::Init(long) /builds/worker/workspace/build/src/dom/media/MediaCache.cpp:2661:17 (libxul.so+0x3a6b530)
    #9 mozilla::ChannelMediaResource::Open(nsIStreamListener**) /builds/worker/workspace/build/src/dom/media/ChannelMediaResource.cpp:520:30 (libxul.so+0x3a3f7bc)
    #10 mozilla::ChannelMediaDecoder::Load(nsIChannel*, bool, nsIStreamListener**) /builds/worker/workspace/build/src/dom/media/ChannelMediaDecoder.cpp:264:19 (libxul.so+0x3a3bc09)
    #11 nsresult mozilla::dom::HTMLMediaElement::SetupDecoder<mozilla::ChannelMediaDecoder, nsIChannel*&, bool&, nsIStreamListener**&>(mozilla::ChannelMediaDecoder*, nsIChannel*&, bool&, nsIStreamListener**&) /builds/worker/workspace/build/src/dom/html/HTMLMediaElement.cpp:5046:27 (libxul.so+0x3949095)
    #12 mozilla::dom::HTMLMediaElement::InitializeDecoderForChannel(nsIChannel*, nsIStreamListener**) /builds/worker/workspace/build/src/dom/html/HTMLMediaElement.cpp:5129:10 (libxul.so+0x392864a)
    #13 mozilla::dom::HTMLMediaElement::MediaLoadListener::OnStartRequest(nsIRequest*) /builds/worker/workspace/build/src/dom/html/HTMLMediaElement.cpp:1244:7 (libxul.so+0x3927906)
    #14 mozilla::net::HttpChannelChild::DoOnStartRequest(nsIRequest*, nsISupports*) /builds/worker/workspace/build/src/netwerk/protocol/http/HttpChannelChild.cpp:707:20 (libxul.so+0xfdf0de)
    #15 mozilla::net::HttpChannelChild::OnStartRequest(nsresult const&, mozilla::net::nsHttpResponseHead const&, bool const&, mozilla::net::nsHttpHeaderArray const&, mozilla::net::ParentLoadInfoForwarderArgs const&, bool const&, bool const&, bool const&, unsigned long const&, int const&, unsigned int const&, nsTString<char> const&, nsTString<char> const&, mozilla::net::NetAddr const&, mozilla::net::NetAddr const&, unsigned int const&, nsTString<char> const&, long const&, bool const&, bool const&, bool const&, mozilla::net::ResourceTimingStructArgs const&, bool const&, mozilla::Maybe<unsigned int> const&, bool const&, nsILoadInfo::CrossOriginOpenerPolicy const&) /builds/worker/workspace/build/src/netwerk/protocol/http/HttpChannelChild.cpp:557:3 (libxul.so+0xfe58c0)
    #16 operator() /builds/worker/workspace/build/src/netwerk/protocol/http/HttpChannelChild.cpp:411:15 (libxul.so+0x102a422)
    #17 std::_Function_handler<void (), mozilla::net::HttpChannelChild::RecvOnStartRequest(nsresult const&, mozilla::net::nsHttpResponseHead const&, bool const&, mozilla::net::nsHttpHeaderArray const&, mozilla::net::ParentLoadInfoForwarderArgs const&, bool const&, bool const&, bool const&, unsigned long const&, int const&, unsigned int const&, nsTString<char> const&, nsTString<char> const&, mozilla::net::NetAddr const&, mozilla::net::NetAddr const&, short const&, unsigned int const&, nsTString<char> const&, long const&, bool const&, bool const&, bool const&, mozilla::net::ResourceTimingStructArgs const&, bool const&, mozilla::Maybe<unsigned int> const&, bool const&, nsILoadInfo::CrossOriginOpenerPolicy const&)::$_5>::_M_invoke(std::_Any_data const&) /builds/worker/fetches/clang/bin/../lib/gcc/x86_64-unknown-linux-gnu/7.4.0/../../../../include/c++/7.4.0/bits/std_function.h:316:2 (libxul.so+0x102a422)
    #18 operator() /builds/worker/fetches/clang/bin/../lib/gcc/x86_64-unknown-linux-gnu/7.4.0/../../../../include/c++/7.4.0/bits/std_function.h:706:14 (libxul.so+0xf59143)
    #19 mozilla::net::ChannelFunctionEvent::Run() /builds/worker/workspace/build/src/obj-firefox/dist/include/mozilla/net/ChannelEventQueue.h:80:25 (libxul.so+0xf59143)
    #20 mozilla::net::ChannelEventQueue::RunOrEnqueue(mozilla::net::ChannelEvent*, bool) /builds/worker/workspace/build/src/obj-firefox/dist/include/mozilla/net/ChannelEventQueue.h:261:10 (libxul.so+0xf41d95)
    #21 mozilla::net::HttpChannelChild::RecvOnStartRequest(nsresult const&, mozilla::net::nsHttpResponseHead const&, bool const&, mozilla::net::nsHttpHeaderArray const&, mozilla::net::ParentLoadInfoForwarderArgs const&, bool const&, bool const&, bool const&, unsigned long const&, int const&, unsigned int const&, nsTString<char> const&, nsTString<char> const&, mozilla::net::NetAddr const&, mozilla::net::NetAddr const&, short const&, unsigned int const&, nsTString<char> const&, long const&, bool const&, bool const&, bool const&, mozilla::net::ResourceTimingStructArgs const&, bool const&, mozilla::Maybe<unsigned int> const&, bool const&, nsILoadInfo::CrossOriginOpenerPolicy const&) /builds/worker/workspace/build/src/netwerk/protocol/http/HttpChannelChild.cpp:401:12 (libxul.so+0xfe4c65)
    #22 mozilla::net::PHttpChannelChild::OnMessageReceived(IPC::Message const&) /builds/worker/workspace/build/src/obj-firefox/ipc/ipdl/PHttpChannelChild.cpp:862:28 (libxul.so+0x14b5303)
    #23 mozilla::dom::PContentChild::OnMessageReceived(IPC::Message const&) /builds/worker/workspace/build/src/obj-firefox/ipc/ipdl/PContentChild.cpp:8355:32 (libxul.so+0x13af7d0)
    #24 mozilla::dom::ContentChild::OnMessageReceived(IPC::Message const&) /builds/worker/workspace/build/src/dom/ipc/ContentChild.cpp:3877:25 (libxul.so+0x427d540)
    #25 mozilla::ipc::MessageChannel::DispatchAsyncMessage(mozilla::ipc::ActorLifecycleProxy*, IPC::Message const&) /builds/worker/workspace/build/src/ipc/glue/MessageChannel.cpp:2215:25 (libxul.so+0x12aaaf6)
    #26 mozilla::ipc::MessageChannel::DispatchMessage(IPC::Message&&) /builds/worker/workspace/build/src/ipc/glue/MessageChannel.cpp:2137:9 (libxul.so+0x12a916a)
    #27 mozilla::ipc::MessageChannel::RunMessage(mozilla::ipc::MessageChannel::MessageTask&) /builds/worker/workspace/build/src/ipc/glue/MessageChannel.cpp:1976:3 (libxul.so+0x12a9d51)
    #28 mozilla::ipc::MessageChannel::MessageTask::Run() /builds/worker/workspace/build/src/ipc/glue/MessageChannel.cpp:2007:13 (libxul.so+0x12aa289)
    #29 mozilla::SchedulerGroup::Runnable::Run() /builds/worker/workspace/build/src/xpcom/threads/SchedulerGroup.cpp:282:20 (libxul.so+0xa5603a)
    #30 nsThread::ProcessNextEvent(bool, bool*) /builds/worker/workspace/build/src/xpcom/threads/nsThread.cpp:1220:14 (libxul.so+0xa6e673)
    #31 NS_ProcessNextEvent(nsIThread*, bool) /builds/worker/workspace/build/src/xpcom/threads/nsThreadUtils.cpp:481:10 (libxul.so+0xa73272)
    #32 mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) /builds/worker/workspace/build/src/ipc/glue/MessagePump.cpp:87:21 (libxul.so+0x12ae4f9)
    #33 mozilla::ipc::MessagePumpForChildProcess::Run(base::MessagePump::Delegate*) /builds/worker/workspace/build/src/ipc/glue/MessagePump.cpp:270:30 (libxul.so+0x12aef0b)
    #34 RunInternal /builds/worker/workspace/build/src/ipc/chromium/src/base/message_loop.cc:315:10 (libxul.so+0x12422cc)
    #35 RunHandler /builds/worker/workspace/build/src/ipc/chromium/src/base/message_loop.cc:308:3 (libxul.so+0x12422cc)
    #36 MessageLoop::Run() /builds/worker/workspace/build/src/ipc/chromium/src/base/message_loop.cc:290:3 (libxul.so+0x12422cc)
    #37 nsBaseAppShell::Run() /builds/worker/workspace/build/src/widget/nsBaseAppShell.cpp:137:27 (libxul.so+0x46ff3e3)
    #38 XRE_RunAppShell() /builds/worker/workspace/build/src/toolkit/xre/nsEmbedFunctions.cpp:943:20 (libxul.so+0x6329ad9)
    #39 mozilla::ipc::MessagePumpForChildProcess::Run(base::MessagePump::Delegate*) /builds/worker/workspace/build/src/ipc/glue/MessagePump.cpp:237:9 (libxul.so+0x12aeeba)
    #40 RunInternal /builds/worker/workspace/build/src/ipc/chromium/src/base/message_loop.cc:315:10 (libxul.so+0x12422cc)
    #41 RunHandler /builds/worker/workspace/build/src/ipc/chromium/src/base/message_loop.cc:308:3 (libxul.so+0x12422cc)
    #42 MessageLoop::Run() /builds/worker/workspace/build/src/ipc/chromium/src/base/message_loop.cc:290:3 (libxul.so+0x12422cc)
    #43 XRE_InitChildProcess(int, char**, XREChildData const*) /builds/worker/workspace/build/src/toolkit/xre/nsEmbedFunctions.cpp:778:34 (libxul.so+0x6329850)
    #44 mozilla::BootstrapImpl::XRE_InitChildProcess(int, char**, XREChildData const*) /builds/worker/workspace/build/src/toolkit/xre/Bootstrap.cpp:67:12 (libxul.so+0x6331542)
    #45 content_process_main /builds/worker/workspace/build/src/browser/app/../../ipc/contentproc/plugin-container.cpp:56:28 (firefox+0xc87c7)
    #46 main /builds/worker/workspace/build/src/browser/app/nsBrowserApp.cpp:303:18 (firefox+0xc87c7)
SUMMARY: ThreadSanitizer: data race /builds/worker/workspace/build/src/mozglue/misc/Mutex_posix.cpp:119:3 in mozilla::detail::MutexImpl::~MutexImpl()
