{% extends 'layouts/layout_base.html' %}

{% load extratags %}

{% block title %}{{ entry.pk }} - {{ entry.shortSignature|escape }}{% endblock title %}

{% block body_content %}
<div class="panel panel-default">
  <div class="panel-heading"><i class="bi bi-card-list"></i> Report</div>
  <div class="panel-body">
    <table class="table">
      <tr><td>Status</td><td>
  {% if entry.bucket %}
        Assigned to bucket <a href="{% url 'reportmanager:sigview' entry.bucket.pk %}">{{ entry.bucket.pk }}</a>.
    {% if entry.bucket.bug %}
        Reported as <a {% if bucket.bug.closed %}class="fixedbug"{% endif %} href="{{ entry.bucket.bug.external_type.url_template|varformat:entry.bucket.bug.external_id }}" target="_blank"> bug {{ entry.bucket.bug.external_id }}</a>.
    {% else %}
        Unreported.
    {% endif %}
  {% else %}
        Not assigned to any bucket.
  {% endif %}

  {% if entry.bucket %}
    {% if not entry.bucket.bug %}
        <br/><br/>
        <div class="btn-group">
          <a href="{% url 'reportmanager:createbug' entry.pk %}" class="btn btn-danger">File a bug</a>
          <assignbutton :bucket="{{ entry.bucket.pk }}" :providers="{{ providers }}" />
        </div>
    {% else %}
        <br/><br/>
        <div class="btn-group">
          <a href="{% url 'reportmanager:createbugcomment' entry.pk %}" class="btn btn-danger">Post a bug comment</a>
        </div>
    {% endif %}
  {% else %}
        <br/><br/>
        <div class="btn-group">
          <a href="{% url 'reportmanager:signew' %}?report_id={{ entry.pk }}" class="btn btn-danger">Create</a>
          <a href="{% url 'reportmanager:findsigs' entry.pk %}" class="btn btn-default">Search</a>
        </div>
  {% endif %}
      </td></tr>
      <tr><td>Created</td><td>{{ entry.created|date:"r" }}</td></tr>
      <tr><td>Client</td><td>{{ entry.client.name|escape }}</td></tr>
      <tr><td>Short Signature</td><td class="wrap-anywhere">{{ entry.shortSignature|escape }}</td></tr>
      <tr><td>Product</td><td>{{ entry.product.name }}</td></tr>
      <tr><td>Version</td><td>{{ entry.product.version }}</td></tr>
      <tr><td>Platform</td><td>{{ entry.platform.name }}</td></tr>
      <tr><td>OS</td><td>{{ entry.os.name }}</td></tr>
      <tr><td>Reported by Tool</td><td>{{ entry.tool.name }}</td></tr>
    </table>

    <div class="btn-group">
      <a href="{% url 'reportmanager:reportedit' entry.pk %}" class="btn btn-default">Edit</a>
      <a href="{% url 'reportmanager:reportdel' entry.pk %}" class="btn btn-danger">Delete</a>
    </div>

    <br/><br/>

  </div>
</div>
{% endblock body_content %}
